function _helper_read_edges(file,last_vertex = None,start_vertex = 0)
  edges = Int[0,3]
  try
    edges = readdlm(file,Int)
  catch e
    print(e)
    return None
  end

  if (last_vertex != None)
    v = [start_vertex:last_vertex]
  else
    v = sort(unique([edges[1:end,1];edges[1:end,2]]))
  end
  vertxs = Dict()
  for vert in v
    vertxs[vert] = 1
  end
  return v,vertxs,edges
end

function read_edges_from_file_1(file;last_vertex= None,directed = false,start_vertex = 0,key_of_edge_attr="cost")

  v,vertxs,edges = _helper_read_edges(file,last_vertex,start_vertex)
  e = ExEdge[]
  for i = 1 : size(edges)[1]
    if (haskey(vertxs,edges[i,1])) && (haskey(vertxs,edges[i,2]))
      edge = ExEdge(i,edges[i,1],edges[i,2])
      edge.attributes[key_of_edge_attr] = edges[i,3]
      push!(e,edge)
    end
  end
  new_graph = graph(Int64[],ExEdge{Int64}[],is_directed = directed)
  for vertex in v
    add_vertex!(new_graph,vertex)
  end
  for edge in e
      add_edge!(new_graph,edge)
  end
  return new_graph
end

function read_edges_from_file_no_selfloops(file;last_vertex= None,directed = false,start_vertex = 0,key_of_edge_attr="cost")

  v,vertxs,edges = _helper_read_edges(file,last_vertex,start_vertex)
  e = ExEdge[]
  for i = 1 : size(edges)[1]
    if (haskey(vertxs,edges[i,1])) && (haskey(vertxs,edges[i,2]))
      if (edges[i,1] != edges[i,2])
        edge = ExEdge(i,edges[i,1],edges[i,2])
        edge.attributes[key_of_edge_attr] = edges[i,3]
        push!(e,edge)
      end
    end
  end
  new_graph = graph(Int64[],ExEdge{Int64}[],is_directed = directed)
  for vertex in v
    add_vertex!(new_graph,vertex)
  end
  for edge in e
      add_edge!(new_graph,edge)
  end
  return new_graph
end

function read_edges_from_file_no_parallel_e(file;last_vertex= None,directed = false,start_vertex = 0,key_of_edge_attr="cost")

  v,vertxs,edges = _helper_read_edges(file,last_vertex,start_vertex)
  e = ExEdge[]
  already_in = Dict()
  for i = 1 : size(edges)[1]
    if (haskey(vertxs,edges[i,1])) && (haskey(vertxs,edges[i,2]))
      if (haskey(already_in,sort([edges[i,1],edges[i,2]])) == false)
        already_in[sort([edges[i,1],edges[i,2]])] = 1
        edge = ExEdge(i,edges[i,1],edges[i,2])
        edge.attributes[key_of_edge_attr] = edges[i,3]
        push!(e,edge)
      end
    end
  end
  new_graph = graph(Int64[],ExEdge{Int64}[],is_directed = directed)
  for vertex in v
    add_vertex!(new_graph,vertex)
  end
  for edge in e
      add_edge!(new_graph,edge)
  end
  return new_graph
end

function read_edges_from_file_no_selfl_or_parallel_e(file;last_vertex= None,directed = false,start_vertex = 0,key_of_edge_attr="cost")

  v,vertxs,edges = _helper_read_edges(file,last_vertex,start_vertex)
  e = ExEdge[]
  already_in = Dict()
  for i = 1 : size(edges)[1]
    if (haskey(vertxs,edges[i,1])) && (haskey(vertxs,edges[i,2]))
      if (edges[i,1] != edges[i,2])
        if (haskey(already_in,sort([edges[i,1],edges[i,2]])) == false)
          already_in[sort([edges[i,1],edges[i,2]])] = 1
          edge = ExEdge(i,edges[i,1],edges[i,2])
          edge.attributes[key_of_edge_attr] = edges[i,3]
          push!(e,edge)
        end
      end
    end
  end
  new_graph = graph(Int64[],ExEdge{Int64}[],is_directed = directed)
  for vertex in v
    add_vertex!(new_graph,vertex)
  end
  for edge in e
      add_edge!(new_graph,edge)
  end
  return new_graph
end


function read_edges_from_file(file;last_vertex = None,directed = false,start_vertex = 0,key_of_edge_attr="cost",selfloops = true,parallel_edges =true )
  if (selfloops) && (parallel_edges)
    read_edges_from_file_1(file,last_vertex = last_vertex,directed = directed,key_of_edge_attr = key_of_edge_attr)
  elseif (selfloops == false) && (parallel_edges)
    read_edges_from_file_no_selfloops(file,last_vertex = last_vertex,directed = directed,key_of_edge_attr = key_of_edge_attr)
  elseif (selfloops) && (parallel_edges == false)
    read_edges_from_file_no_parallel_e(file,last_vertex = last_vertex,directed = directed,key_of_edge_attr = key_of_edge_attr)
  else
    read_edges_from_file_no_selfl_or_parallel_e(file,last_vertex = last_vertex,directed = directed,key_of_edge_attr = key_of_edge_attr)
  end
end

function save_graph_to_file(g;file = None,edge_key_att = None)
  if file == None
    file = "graph.txt"
  end
  edgs = edges(g)
  arr = Array(Int64,length(edgs),3)
  if edge_key_att == None
    for i=1:length(edgs)
    arr[i,1] = edgs[i].source
    arr[i,2] = edgs[i].target
    arr[i,3] = 1
    end
  else
  for i=1:length(edgs)
    arr[i,1] = edgs[i].source
    arr[i,2] = edgs[i].target
    arr[i,3] = edgs[i].attributes[edge_key_att]
  end
  end
  writedlm(file,arr," ")

end

function create_subgraph(vertex_set,edge_list,directed)
  new_graph = graph(Int64[],ExEdge{Int64}[],is_directed = directed)
  vertex_set_d = Dict()
  for vertex in vertex_set
    add_vertex!(new_graph,vertex)
    vertex_set_d[vertex] = 1
  end
  for edge in edge_list
    if (haskey(vertex_set_d,edge.source)) && (haskey(vertex_set_d,edge.target))
      new_edge = ExEdge(edge.index,edge.source,edge.target)
      for (k,v) in edge.attributes
        new_edge.attributes[k] = v
      end
        add_edge!(new_graph,new_edge)
    end
  end
  return new_graph
end

function all_neighbors(v,g)
  if is_directed(g)
    neighbr = out_neighbors(v,g)
    for n in in_neighbors(v,g)
      append!(neighbr,n)
    end
    return neighbr
  else
    return out_neighbors(v,g)
  end
end

function all_degree(v,g)
  if is_directed(g)
    return out_degree(v,g) + in_degree(v,g)
  else
    return out_degree(v,g)
  end
end

function occurrence_of_degree(g::GenericGraph)
  g_vertices = vertices(g)
  degrees = zeros(Int64,0)
  max = 0
  d = 0
  for i = 1:length(g_vertices)
    d = all_degree(g_vertices[i],g)+1
    if max < d
      for j=1:(d-max)
        push!(degrees,0)
      end
      degrees[d] +=1
      max = d
    else
      degrees[d] +=1
    end
  end
  return degrees
end
